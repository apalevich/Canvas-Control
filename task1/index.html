<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task 1 â€” Stars and Colors</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="main" class="main">
        <canvas class="canvas_control" id="playField">
            Please enable Javascript to see the content
        </canvas>
        <canvas class="canvas_result" id="playStatus" width="600" height="50">
            Please enable Javascript to see the content
        </canvas>
    </div>
</body>
<script>
    // SETTINGS
    const PLAYFIELD_SIZE = {width: 600, height: 600};

    const FIGURES_SETTINGS = {
        quantity: 5,
        colors: [
            'red', 'blue', 'green', 'yellow', 'black'
        ],
        coordinates: [
            {x: 90, y: 0},
            {x: 30, y: 188},
            {x: 180, y: 68},
            {x: 0, y: 68},
            {x: 150, y: 18},
        ]
    };

    // INITIALIZATION
    const canvas = document.getElementById('playField');
    canvas.setAttribute('width', PLAYFIELD_SIZE.width)
    canvas.setAttribute('height', PLAYFIELD_SIZE.height)

    if (canvas.getContext) {
        const ctx = canvas.getContext("2d");

        

        // drawPolygon(ctx, 'green', 10, 10);
        // drawPolygon(ctx, 'green', 200, 10);
        // drawPolygon(ctx, 'green', 400, 10);
        // drawPolygon(ctx, 'green', 100, 220);
        // drawPolygon(ctx, 'green', 300, 220);

        // ctx.getImageData(105,105,1,1)
    }
    
    function calculateFigureSize(coordinates) {;
        const minMax = coordinates.reduce((acc, el) => {
            if (el.x < acc.x.min) acc.x.min = el.x;
            if (el.x > acc.x.max) acc.x.max = el.x;
            if (el.y < acc.y.min) acc.y.min = el.y;
            if (el.y > acc.y.max) acc.y.max = el.y;
            return acc;
        }, {x: {min: Infinity, max: 0}, y: {min: Infinity, max: 0}});
        const size = {
            x: minMax.x.max - minMax.x.min,
            y: minMax.y.max - minMax.y.min,
        }
        return size;
    }

    function drawPolygon(ctx, style, startX = 0, startY = 0) {
        ctx.fillStyle = style;
        ctx.beginPath();
        FIGURE_COORDINATES.forEach(el => {
            ctx.lineTo(
                el[0]+startX,
                el[1]+startY,
            );
        })
        ctx.closePath();
        ctx.fill();
    }

    function fillCanvas(canvas, figures) {
        // Calculations to set position of items
        const figureSize = calculateFigureSize(figures.coordinates);
        const itemsInRow = Math.floor(canvas.width / figureSize.x);
        const itemsInCol = Math.ceil(figures.quantity / itemsInRow);
        const colsWidth = canvas.width / itemsInRow;
        const lastRowWidth = canvas.width / (FIGURES_SETTINGS.quantity % itemsInRow);
        const rowsHeight = canvas.height / itemsInCol;

        if (itemsInCol * figureSize.y > PLAYFIELD_SIZE.height) {
            alert('Too many figures. Unable to launch, check settings');
            return false;
        } 
        
        for (let i=0; i<canvas.quantity; i++) {
            const curRow = Math.floor(i / itemsInRow);
            const curCol = Math.floor(i / itemsInCol);

            const isLastRow = curRow+1 === itemsInCol;

            const horShift = horShift ?
                (lastRowWidth - figureSize.x) / 2 :
                (colsWidth - figureSize.x) / 2;
            const vertShift = (rowsHeight - figureSize.y) / 2;

            const style = FIGURES_SETTINGS.colors[i%canvas.quantity];
            const startX = curCol * colsWidth + horShift;
            const startY;

            // const args = `style: ${}, startX = `
            console.log()
        }

        // console.log(figureSize, itemsInRow, itemsInCol, colsWidth, rowsHeight, lastRowWidth)
    }
</script>
</html>